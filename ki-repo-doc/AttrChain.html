<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Class: AttrChain
  
    &mdash; Documentation by YARD 0.8.7
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '';
  framesUrl = "frames.html#!" + escape(window.location.href);
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="_index.html">Index (A)</a> &raquo;
    
    
    <span class="title">AttrChain</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><h1>Class: AttrChain
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName"><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></span>
      
        <ul class="fullTree">
          <li><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></li>
          
            <li class="next">AttrChain</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
  
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">lib/util/attr_chain.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>Attaches configurable behaviour to accessor methods</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>class</span> <span class='const'>Foo</span>
   <span class='id identifier rubyid_attr_chain'>attr_chain</span> <span class='symbol'>:name</span><span class='comma'>,</span> <span class='symbol'>:require</span>
   <span class='id identifier rubyid_attr_chain'>attr_chain</span> <span class='symbol'>:email</span><span class='comma'>,</span> <span class='tlambda'>-&gt;</span> <span class='tlambeg'>{</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='rbrace'>}</span>
   <span class='id identifier rubyid_attr_chain'>attr_chain</span> <span class='symbol'>:birth_day</span><span class='comma'>,</span> <span class='symbol'>:immutable</span><span class='comma'>,</span> <span class='symbol'>:valid</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_lambda'>lambda</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_i'>i</span><span class='op'>|</span> <span class='lparen'>(</span><span class='int'>1870</span><span class='op'>..</span><span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='period'>.</span><span class='id identifier rubyid_year'>year</span><span class='op'>+</span><span class='int'>1</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_i'>i</span><span class='rparen'>)</span> <span class='rbrace'>}</span><span class='comma'>,</span> <span class='symbol'>:require</span> <span class='op'>=&gt;</span> <span class='kw'>true</span>
   <span class='id identifier rubyid_attr_chain'>attr_chain</span> <span class='symbol'>:children</span><span class='comma'>,</span> <span class='symbol'>:convert</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_lambda'>lambda</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_s'>s</span><span class='op'>|</span> <span class='id identifier rubyid_s'>s</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='rbrace'>}</span>
<span class='kw'>end</span>
</code></pre>

<p>Sets up public methods variable_name and variable_name= which both can be
used to access the fields. Giving any parameters for the method makes it a
"set" operation and giving no parameters makes it a "get" operation. "Set"
stores the value and returns self, so set calls can be chained. "Get"
returns the stored value.</p>

<pre class="code ruby"><code class="ruby">foo.email(&quot;test@email.com&quot;).name(&quot;test&quot;)
foo.email =&gt; &quot;test@email.com&quot;
foo.name =&gt; &quot;test&quot;
</code></pre>

<p>Parameters can be given in short and long format. Short format works by
identifying parameter types, long format works by given the name and value
as hash parameters:</p>
<ul><li>
<p><code>:require=&gt;&quot;You need to define xxx first&quot;</code>,
<code>:require=&gt;true</code>, short: <code>:require</code> - an exception
is thrown if target field is not defined</p>
</li><li>
<p><code>:default=&gt; -&gt; {true}</code>, short: <code>-&gt;
{Array.new}</code> - if target field has not been defined, executes proc
and stores value. proc is executed using object.instance_exec: object's
fields &amp; methds are available</p>
</li><li>
<p><code>:immutable=&gt;true</code>, short: <code>:immutable</code> - an
exception is thrown if target field is defined a second time</p>
</li><li>
<p><code>:valid=&gt;[1,2,3,&quot;a&quot;, lambda {|s|
s.include?(&quot;b&quot;)}]</code>, <code>:valid =&gt; lambda {|s|
s.include?(&quot;b&quot;)}</code>, short:
<code>[1,2,3,&quot;a&quot;]</code> - List of valid values. If any matches,
sets value. If none matches, raises exception. Long form wraps single
arguments to a list.</p>
</li><li>
<p><code>:convert=&gt; -&gt;(s) { s+1 }</code> - Converts input value using
the defined proc</p>
</li><li>
<p><code>:accessor=&gt;InstanceVariableAccessor.new</code> - Makes it possible
to set values in other source, for example a hash. By default uses
InstanceVariableAccessor</p>
</li></ul>

<p>Advantages for using attr_chain</p>
<ul><li>
<p>attr_chain has a compact syntax for many important programming concepts
-&gt; less manually written boilerplate code is needed</p>
</li><li>
<p>:default makes it easy to isolate functionality to a default value while
still making it easy to override the default behaviour</p>
</li><li>
<p>:default adds easy lazy evalution and memoization to the attribute, default
value is evaluated only if needed</p>
</li><li>
<p>Testing becomes easier when objects have more exposed fields</p>
</li><li>
<p>:require converts tricky nil exceptions in to useful errors. Instead of the
"undefined method 'bar' for nil:NilClass" you get a good error message that
states which field was not defined</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_foo'>foo</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_bar'>bar</span> <span class='comment'># if name has not been defined, raises &quot;'name' has not been set&quot; exception</span></code></pre>
</li><li>
<p>:immutable, :valid and :convert make complex validations and converts easy</p>
</li></ul>

<p>Warnings about attr_chain</p>
<ul><li>
<p>Performance has not been measured and attr_chain is probably not efficient.
If there are tight inner loops, it's better to cache the value and store it
afterwards</p>
</li><li>
<p>There has not been tests for memory leaks. It's plain ruby so GC should
take care of everything</p>
</li><li>
<p>Excessive attr_chain usage makes classes a mess. Try to keep your classes
short and attr_chain count below 10.</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="AttrChain/InstanceVariableAccessor.html" title="AttrChain::InstanceVariableAccessor (class)">InstanceVariableAccessor</a></span></li>
    
      <li><span class='object_link'><a href="Object.html#attr_chain-class_method" title="Object.attr_chain (method)">Object.attr_chain</a></span></li>
    
      <li><span class='object_link'><a href="Module.html#attr_chain-instance_method" title="Module#attr_chain (method)">Module#attr_chain</a></span></li>
    
  </ul>

</div><h2>Defined Under Namespace</h2>
<p class="children">
  
    
  
    
      <strong class="classes">Classes:</strong> <span class='object_link'><a href="AttrChain/HashAccessor.html" title="AttrChain::HashAccessor (class)">HashAccessor</a></span>, <span class='object_link'><a href="AttrChain/InstanceVariableAccessor.html" title="AttrChain::InstanceVariableAccessor (class)">InstanceVariableAccessor</a></span>
    
  
</p>

  <h2>Constant Summary</h2>
  
    <dl class="constants">
      
        <dt id="InstanceVariableAccess-constant" class="">InstanceVariableAccess =
          
        </dt>
        <dd><pre class="code"><span class='const'>InstanceVariableAccessor</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span></pre></dd>
      
        <dt id="HashAccess-constant" class="">HashAccess =
          
        </dt>
        <dd><pre class="code"><span class='const'>HashAccessor</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span></pre></dd>
      
    </dl>
  







  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#attr_chain-instance_method" title="#attr_chain (instance method)">- (Object) <strong>attr_chain</strong>(object, args) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Handles incoming methods for "get" and "set" * called by methods defined to
class * configuration is stored as instance variables, the class knows
which variable is being handled * method call parameters come as list of
parameters.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">- (AttrChain) <strong>initialize</strong>(clazz, variable_name, attr_configs) </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Parses parameters with parse_short_syntax and set_parameters and configures
class methods * each attr_chain definition uses one instance of AttrChain
which holds the configuration for the definition * Object::define_method is
used to add two methods to target class and when called both of these
methods call attr_chain with their parameters.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#parse_short_syntax-instance_method" title="#parse_short_syntax (instance method)">- (Object) <strong>parse_short_syntax</strong>(variable_name, attr_configs) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Converts short syntax entries in attr_configs to long syntax * warns about
not supported values and already defined values.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#set_parameters-instance_method" title="#set_parameters (instance method)">- (Object) <strong>set_parameters</strong>(variable_name, params) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Parses long syntax values and sets configuration for this field.</p>
</div></span>
  
</li>

      
    </ul>
  

<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    - (<tt><span class='object_link'><a href="" title="AttrChain (class)">AttrChain</a></span></tt>) <strong>initialize</strong>(clazz, variable_name, attr_configs) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Parses parameters with parse_short_syntax and set_parameters and configures
class methods</p>
<ul><li>
<p>each attr_chain definition uses one instance of AttrChain which holds the
configuration for the definition</p>
</li><li>
<p>Object::define_method is used to add two methods to target class and when
called both of these methods call attr_chain with their parameters</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><span class='object_link'><a href="Object.html#attr_chain-class_method" title="Object.attr_chain (method)">Object.attr_chain</a></span></li>
    
      <li><span class='object_link'><a href="Module.html#attr_chain-instance_method" title="Module#attr_chain (method)">Module#attr_chain</a></span></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


65
66
67
68
69
70
71
72
73
74
75
76
77</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/util/attr_chain.rb', line 65</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_clazz'>clazz</span><span class='comma'>,</span> <span class='id identifier rubyid_variable_name'>variable_name</span><span class='comma'>,</span> <span class='id identifier rubyid_attr_configs'>attr_configs</span><span class='rparen'>)</span>
  <span class='ivar'>@variable_name</span> <span class='op'>=</span> <span class='id identifier rubyid_variable_name'>variable_name</span>
  <span class='ivar'>@accessor</span> <span class='op'>=</span> <span class='const'>InstanceVariableAccess</span>
  <span class='id identifier rubyid_set_parameters'>set_parameters</span><span class='lparen'>(</span><span class='id identifier rubyid_variable_name'>variable_name</span><span class='comma'>,</span> <span class='id identifier rubyid_parse_short_syntax'>parse_short_syntax</span><span class='lparen'>(</span><span class='id identifier rubyid_variable_name'>variable_name</span><span class='comma'>,</span> <span class='id identifier rubyid_attr_configs'>attr_configs</span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_me'>me</span> <span class='op'>=</span> <span class='kw'>self</span>
  <span class='id identifier rubyid_attr_call'>attr_call</span> <span class='op'>=</span> <span class='id identifier rubyid_lambda'>lambda</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='op'>|</span> <span class='id identifier rubyid_me'>me</span><span class='period'>.</span><span class='id identifier rubyid_attr_chain'>attr_chain</span><span class='lparen'>(</span><span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
  <span class='lbracket'>[</span><span class='id identifier rubyid_variable_name'>variable_name</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_variable_name'>variable_name</span><span class='rbrace'>}</span><span class='tstring_content'>=</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_method_name'>method_name</span><span class='op'>|</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_clazz'>clazz</span><span class='period'>.</span><span class='id identifier rubyid_method_defined?'>method_defined?</span><span class='lparen'>(</span><span class='id identifier rubyid_method_name'>method_name</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_clazz'>clazz</span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span><span class='lparen'>(</span><span class='symbol'>:undef_method</span><span class='comma'>,</span> <span class='id identifier rubyid_method_name'>method_name</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_clazz'>clazz</span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span><span class='lparen'>(</span><span class='symbol'>:define_method</span><span class='comma'>,</span> <span class='id identifier rubyid_method_name'>method_name</span><span class='comma'>,</span> <span class='id identifier rubyid_attr_call'>attr_call</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="attr_chain-instance_method">
  
    - (<tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt>) <strong>attr_chain</strong>(object, args) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Handles incoming methods for "get" and "set"</p>
<ul><li>
<p>called by methods defined to class</p>
</li><li>
<p>configuration is stored as instance variables, the class knows which
variable is being handled</p>
</li><li>
<p>method call parameters come as list of parameters</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/util/attr_chain.rb', line 152</span>

<span class='kw'>def</span> <span class='id identifier rubyid_attr_chain'>attr_chain</span><span class='lparen'>(</span><span class='id identifier rubyid_object'>object</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_args'>args</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
    <span class='kw'>if</span> <span class='op'>!</span><span class='ivar'>@accessor</span><span class='period'>.</span><span class='id identifier rubyid_defined?'>defined?</span><span class='lparen'>(</span><span class='id identifier rubyid_object'>object</span><span class='comma'>,</span> <span class='ivar'>@variable_name</span><span class='rparen'>)</span>
      <span class='kw'>if</span> <span class='kw'>defined?</span> <span class='ivar'>@default</span>
        <span class='ivar'>@accessor</span><span class='period'>.</span><span class='id identifier rubyid_set'>set</span><span class='lparen'>(</span><span class='id identifier rubyid_object'>object</span><span class='comma'>,</span> <span class='ivar'>@variable_name</span><span class='comma'>,</span> <span class='id identifier rubyid_object'>object</span><span class='period'>.</span><span class='id identifier rubyid_instance_exec'>instance_exec</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='ivar'>@default</span><span class='rparen'>)</span><span class='rparen'>)</span>
      <span class='kw'>elsif</span> <span class='kw'>defined?</span> <span class='ivar'>@require</span>
        <span class='kw'>if</span> <span class='ivar'>@require</span><span class='period'>.</span><span class='id identifier rubyid_kind_of?'>kind_of?</span><span class='lparen'>(</span><span class='const'>String</span><span class='rparen'>)</span>
          <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>'</span><span class='embexpr_beg'>#{</span><span class='ivar'>@variable_name</span><span class='rbrace'>}</span><span class='tstring_content'>' has not been set: </span><span class='embexpr_beg'>#{</span><span class='ivar'>@require</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>else</span>
          <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>'</span><span class='embexpr_beg'>#{</span><span class='ivar'>@variable_name</span><span class='rbrace'>}</span><span class='tstring_content'>' has not been set</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='ivar'>@accessor</span><span class='period'>.</span><span class='id identifier rubyid_get'>get</span><span class='lparen'>(</span><span class='id identifier rubyid_object'>object</span><span class='comma'>,</span> <span class='ivar'>@variable_name</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='kw'>if</span> <span class='kw'>defined?</span><span class='lparen'>(</span><span class='ivar'>@immutable</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='ivar'>@accessor</span><span class='period'>.</span><span class='id identifier rubyid_defined?'>defined?</span><span class='lparen'>(</span><span class='id identifier rubyid_object'>object</span><span class='comma'>,</span> <span class='ivar'>@variable_name</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>'</span><span class='embexpr_beg'>#{</span><span class='ivar'>@variable_name</span><span class='rbrace'>}</span><span class='tstring_content'>' has been set once already</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_value_to_set'>value_to_set</span> <span class='op'>=</span> <span class='kw'>if</span> <span class='id identifier rubyid_args'>args</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>==</span> <span class='int'>1</span>
                     <span class='id identifier rubyid_args'>args</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
                   <span class='kw'>else</span>
                     <span class='id identifier rubyid_args'>args</span>
                   <span class='kw'>end</span>
    <span class='kw'>if</span> <span class='kw'>defined?</span> <span class='ivar'>@convert</span>
      <span class='id identifier rubyid_value_to_set'>value_to_set</span> <span class='op'>=</span> <span class='id identifier rubyid_object'>object</span><span class='period'>.</span><span class='id identifier rubyid_instance_exec'>instance_exec</span><span class='lparen'>(</span><span class='id identifier rubyid_value_to_set'>value_to_set</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='ivar'>@convert</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
    <span class='kw'>if</span> <span class='kw'>defined?</span><span class='lparen'>(</span><span class='ivar'>@valid_items</span><span class='rparen'>)</span> <span class='op'>||</span> <span class='kw'>defined?</span><span class='lparen'>(</span><span class='ivar'>@valid_procs</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_is_valid'>is_valid</span> <span class='op'>=</span> <span class='kw'>false</span>
      <span class='kw'>if</span> <span class='kw'>defined?</span><span class='lparen'>(</span><span class='ivar'>@valid_items</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='ivar'>@valid_items</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_value_to_set'>value_to_set</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_is_valid'>is_valid</span> <span class='op'>=</span> <span class='kw'>true</span>
      <span class='kw'>end</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_is_valid'>is_valid</span> <span class='op'>==</span> <span class='kw'>false</span> <span class='op'>&amp;&amp;</span> <span class='kw'>defined?</span><span class='lparen'>(</span><span class='ivar'>@valid_procs</span><span class='rparen'>)</span>
        <span class='ivar'>@valid_procs</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_valid_proc'>valid_proc</span><span class='op'>|</span>
          <span class='kw'>if</span> <span class='id identifier rubyid_is_valid'>is_valid</span><span class='op'>=</span><span class='id identifier rubyid_object'>object</span><span class='period'>.</span><span class='id identifier rubyid_instance_exec'>instance_exec</span><span class='lparen'>(</span><span class='id identifier rubyid_value_to_set'>value_to_set</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_valid_proc'>valid_proc</span><span class='rparen'>)</span>
            <span class='kw'>break</span>
          <span class='kw'>end</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_is_valid'>is_valid</span> <span class='op'>==</span> <span class='kw'>false</span>
        <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>invalid value for '</span><span class='embexpr_beg'>#{</span><span class='ivar'>@variable_name</span><span class='rbrace'>}</span><span class='tstring_content'>'</span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='ivar'>@accessor</span><span class='period'>.</span><span class='id identifier rubyid_set'>set</span><span class='lparen'>(</span><span class='id identifier rubyid_object'>object</span><span class='comma'>,</span> <span class='ivar'>@variable_name</span><span class='comma'>,</span> <span class='id identifier rubyid_value_to_set'>value_to_set</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_object'>object</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="parse_short_syntax-instance_method">
  
    - (<tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt>) <strong>parse_short_syntax</strong>(variable_name, attr_configs) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Converts short syntax entries in attr_configs to long syntax</p>
<ul><li>
<p>warns about not supported values and already defined values</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/util/attr_chain.rb', line 81</span>

<span class='kw'>def</span> <span class='id identifier rubyid_parse_short_syntax'>parse_short_syntax</span><span class='lparen'>(</span><span class='id identifier rubyid_variable_name'>variable_name</span><span class='comma'>,</span> <span class='id identifier rubyid_attr_configs'>attr_configs</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_params'>params</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='id identifier rubyid_attr_configs'>attr_configs</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_attr_config'>attr_config</span><span class='op'>|</span>
    <span class='id identifier rubyid_key_values'>key_values</span> <span class='op'>=</span> <span class='kw'>if</span> <span class='lbracket'>[</span><span class='symbol'>:require</span><span class='comma'>,</span> <span class='symbol'>:immutable</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_attr_config'>attr_config</span><span class='rparen'>)</span>
                   <span class='lbracket'>[</span><span class='lbracket'>[</span><span class='id identifier rubyid_attr_config'>attr_config</span><span class='comma'>,</span> <span class='kw'>true</span><span class='rbracket'>]</span><span class='rbracket'>]</span>
                 <span class='kw'>elsif</span> <span class='id identifier rubyid_attr_config'>attr_config</span><span class='period'>.</span><span class='id identifier rubyid_kind_of?'>kind_of?</span><span class='lparen'>(</span><span class='const'>Proc</span><span class='rparen'>)</span>
                   <span class='lbracket'>[</span><span class='lbracket'>[</span><span class='symbol'>:default</span><span class='comma'>,</span> <span class='id identifier rubyid_attr_config'>attr_config</span><span class='rbracket'>]</span><span class='rbracket'>]</span>
                 <span class='kw'>elsif</span> <span class='id identifier rubyid_attr_config'>attr_config</span><span class='period'>.</span><span class='id identifier rubyid_kind_of?'>kind_of?</span><span class='lparen'>(</span><span class='const'>Array</span><span class='rparen'>)</span>
                   <span class='lbracket'>[</span><span class='lbracket'>[</span><span class='symbol'>:valid</span><span class='comma'>,</span> <span class='id identifier rubyid_attr_config'>attr_config</span><span class='rbracket'>]</span><span class='rbracket'>]</span>
                 <span class='kw'>elsif</span> <span class='id identifier rubyid_attr_config'>attr_config</span><span class='period'>.</span><span class='id identifier rubyid_kind_of?'>kind_of?</span><span class='lparen'>(</span><span class='const'>Hash</span><span class='rparen'>)</span>
                   <span class='id identifier rubyid_all'>all</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
                   <span class='id identifier rubyid_attr_config'>attr_config</span><span class='period'>.</span><span class='id identifier rubyid_each_pair'>each_pair</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_pair'>pair</span><span class='op'>|</span>
                     <span class='id identifier rubyid_all'>all</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_pair'>pair</span>
                   <span class='kw'>end</span>
                   <span class='id identifier rubyid_all'>all</span>
                 <span class='kw'>else</span>
                   <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>attr_chain :</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_variable_name'>variable_name</span><span class='rbrace'>}</span><span class='tstring_content'> unsupported parameter: '</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_attr_config'>attr_config</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='rbrace'>}</span><span class='tstring_content'>'</span><span class='tstring_end'>&quot;</span></span>
                 <span class='kw'>end</span>
    <span class='id identifier rubyid_key_values'>key_values</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='op'>|</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>attr_chain :</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_variable_name'>variable_name</span><span class='rbrace'>}</span><span class='tstring_content'>, :</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_key'>key</span><span class='rbrace'>}</span><span class='tstring_content'> was already defined to '</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='id identifier rubyid_key'>key</span><span class='rbracket'>]</span><span class='rbrace'>}</span><span class='tstring_content'>' (new value: '</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_value'>value</span><span class='rbrace'>}</span><span class='tstring_content'>')</span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>end</span>
      <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='id identifier rubyid_key'>key</span><span class='rbracket'>]</span><span class='op'>=</span><span class='id identifier rubyid_value'>value</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_params'>params</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="set_parameters-instance_method">
  
    - (<tt><span class='object_link'><a href="Object.html" title="Object (class)">Object</a></span></tt>) <strong>set_parameters</strong>(variable_name, params) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Parses long syntax values and sets configuration for this field</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/util/attr_chain.rb', line 110</span>

<span class='kw'>def</span> <span class='id identifier rubyid_set_parameters'>set_parameters</span><span class='lparen'>(</span><span class='id identifier rubyid_variable_name'>variable_name</span><span class='comma'>,</span> <span class='id identifier rubyid_params'>params</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_each_pair'>each_pair</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='op'>|</span>
    <span class='kw'>case</span> <span class='id identifier rubyid_key'>key</span>
      <span class='kw'>when</span> <span class='symbol'>:require</span>
        <span class='ivar'>@require</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>
      <span class='kw'>when</span> <span class='symbol'>:default</span>
        <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_kind_of?'>kind_of?</span><span class='lparen'>(</span><span class='const'>Proc</span><span class='rparen'>)</span>
          <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>attr_chain :</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_variable_name'>variable_name</span><span class='rbrace'>}</span><span class='tstring_content'>, :default needs to be a Proc, not '</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='rbrace'>}</span><span class='tstring_content'>'</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>end</span>
        <span class='ivar'>@default</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>
      <span class='kw'>when</span> <span class='symbol'>:immutable</span>
        <span class='ivar'>@immutable</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>
      <span class='kw'>when</span> <span class='symbol'>:valid</span>
        <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_kind_of?'>kind_of?</span><span class='lparen'>(</span><span class='const'>Array</span><span class='rparen'>)</span>
          <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_value'>value</span><span class='rbracket'>]</span>
        <span class='kw'>end</span>
        <span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_valid'>valid</span><span class='op'>|</span>
          <span class='kw'>if</span> <span class='id identifier rubyid_valid'>valid</span><span class='period'>.</span><span class='id identifier rubyid_kind_of?'>kind_of?</span><span class='lparen'>(</span><span class='const'>Proc</span><span class='rparen'>)</span>
            <span class='ivar'>@valid_procs</span> <span class='op'>||=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
            <span class='ivar'>@valid_procs</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_valid'>valid</span>
          <span class='kw'>else</span>
            <span class='ivar'>@valid_items</span> <span class='op'>||=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
            <span class='ivar'>@valid_items</span><span class='lbracket'>[</span><span class='id identifier rubyid_valid'>valid</span><span class='rbracket'>]</span><span class='op'>=</span><span class='id identifier rubyid_valid'>valid</span>
          <span class='kw'>end</span>
        <span class='kw'>end</span>
      <span class='kw'>when</span> <span class='symbol'>:convert</span>
        <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_kind_of?'>kind_of?</span><span class='lparen'>(</span><span class='const'>Proc</span><span class='rparen'>)</span>
          <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>attr_chain :</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_variable_name'>variable_name</span><span class='rbrace'>}</span><span class='tstring_content'>, :convert needs to be a Proc, not '</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='rbrace'>}</span><span class='tstring_content'>'</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>end</span>
        <span class='ivar'>@convert</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>
      <span class='kw'>when</span> <span class='symbol'>:accessor</span>
        <span class='ivar'>@accessor</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>attr_chain :</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_variable_name'>variable_name</span><span class='rbrace'>}</span><span class='tstring_content'> unsupported parameter: '</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_key'>key</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='rbrace'>}</span><span class='tstring_content'>'</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

    <div id="footer">
  Generated on Fri Aug  9 12:57:02 2013 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.7 (ruby-1.9.3).
</div>

  </body>
</html>